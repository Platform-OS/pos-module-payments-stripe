---
method: post
layout: null
---
{% liquid
  function valid_webhook = 'modules/payments_stripe/commands/webhooks/must_be_valid_webhook', webhook_path: '/payments/stripe/checkout_webhook', context: context
  unless valid_webhook
    response_status 403
    break
  endunless

  function object = 'modules/payments_stripe/commands/webhooks/checkout_session_completed/call', post_params: context.post_params, current_user: context.current_user
  if object.valid
    echo object
  else
    response_status 500
    echo object
  endif
%}
