---
slug: payments/stripe/checkout_session/:transaction_id
method: post
---
{% liquid
  function transaction = 'modules/payments/queries/transactions/find', id: context.params.transaction_id
%}
{% parse_json data %}
{
 "payment_method_types": ["card"],
 "line_items": {{ params.line_items | json }},
  "client_reference_id": "{{ transaction.id }}",
  "mode": "payment",
  "success_url": "{{ params.success_url}}",
  "cancel_url": "{{ params.cancel_url }}"
}
{% endparse_json %}

{% liquid
  function checkout_session = 'modules/payments_stripe/commands/stripe_checkout/create', object: data

  redirect_to checkout_session.url, status: 303
%}
