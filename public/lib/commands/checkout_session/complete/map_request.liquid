{% liquid
  assign data = '{}' | parse_json
  if object.request_data
    assign response = object.request_data | parse_json
    assign data = null | hash_merge: external_id: response.client_reference_id
    if response.status == 'complete' and response.payment_status == 'paid'
      hash_assign data['status'] = 'success'
    else
      hash_assign data['status'] = 'failed'
    endif
    hash_assign data['valid'] = true
  else
    hash_assign data['valid'] = false
  endif

  return data
%}
